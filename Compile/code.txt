function TEditor.CharPtr(P: Word; Target: Integer): Word;
var  Pos: Integer;
begin 
  Pos := 0;
while (Pos < Target)and(P< BufLen) and (BufChar(P) <> #13) do  begin
    if BufChar(P) = #9 then Pos := Pos + 7;
    Inc(Pos);    Inc(P);
  end;
  if Pos  > Target then Dec(P);
  CharPtr := P;
end;